@inherits LayoutComponentBase

<!-- Top navbar component -->
<TopNavbar />

<!-- Cascading layout context for secondary navbar and page content -->
<CascadingValue Value="LayoutContext" IsFixed="false">
<br>
<h2>ðŸ“š Admin Dashboard</h2>
    <!-- Secondary navbar: View selector buttons -->
    <nav class="sub-navbar bg-white border-bottom py-3">
        <div class="container-fluid d-flex justify-content-center flex-wrap gap-4">

            <button class="btn btn-secondary action-rect-btn d-flex align-items-center gap-2 @(LayoutContext.SelectedRole == "" ? "action-active-secondary" : "")"
                    @onclick="@(() => HandleRoleSelect(""))" title="All Users">
                <i class="bi bi-people-fill fs-4"></i>
                <span>Users</span>
            </button>

            <button class="btn btn-info text-white action-rect-btn d-flex align-items-center gap-2 @(LayoutContext.SelectedRole == "Subjects" ? "action-active-info" : "")"
                    @onclick="@(() => HandleRoleSelect("Subjects"))" title="Subjects">
                <i class="bi bi-book fs-4"></i>
                <span>Subjects</span>
            </button>

            <button class="btn btn-warning action-rect-btn d-flex align-items-center gap-2 @(LayoutContext.SelectedRole == "Notifications" ? "action-active-warning" : "")"
                    @onclick="@(() => HandleRoleSelect("Notifications"))" title="Notifications">
                <i class="bi bi-bell-fill fs-4"></i>
                <span>Notifications</span>
            </button>

        </div>
    </nav>

    <!-- Page content -->
    <div class="container-fluid p-4">
        @Body
    </div>

</CascadingValue>

@code {
    public class AdminLayoutContext
    {
        public string SelectedRole { get; set; } = string.Empty;
        public Action<string> RoleSelectedCallback { get; set; } = delegate { };
    }

    private AdminLayoutContext LayoutContext { get; set; } = new();

    private void HandleRoleSelect(string role)
    {
        LayoutContext.RoleSelectedCallback.Invoke(role);
        LayoutContext.SelectedRole = role;
        StateHasChanged();
    }

    public void SetContext(string selectedRole, Action<string> callback)
    {
        LayoutContext.SelectedRole = selectedRole;
        LayoutContext.RoleSelectedCallback = callback;
        StateHasChanged();
    }
}
